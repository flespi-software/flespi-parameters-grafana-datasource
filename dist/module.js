define(["@grafana/data","rxjs","@grafana/runtime","react","@grafana/ui","lodash"],((e,t,r,n,a,l)=>(()=>{"use strict";var o={305:t=>{t.exports=e},545:e=>{e.exports=r},388:e=>{e.exports=a},980:e=>{e.exports=l},650:e=>{e.exports=n},177:e=>{e.exports=t}},i={};function c(e){var t=i[e];if(void 0!==t)return t.exports;var r=i[e]={exports:{}};return o[e](r,r.exports,c),r.exports}c.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return c.d(t,{a:t}),t},c.d=(e,t)=>{for(var r in t)c.o(t,r)&&!c.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};return(()=>{c.r(s),c.d(s,{plugin:()=>Tt});var e=c(305),t=c(177),r=c(545);function n(e){return"function"==typeof e}var a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},a(e,t)};function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function o(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function i(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,l=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=l.next()).done;)o.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=l.return)&&r.call(l)}finally{if(a)throw a.error}}return o}function u(e,t,r){if(r||2===arguments.length)for(var n,a=0,l=t.length;a<l;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))}Object.create,Object.create;var p,f=((p=function(e){var t;t=this,Error.call(t),t.stack=(new Error).stack,this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e}).prototype=Object.create(Error.prototype),p.prototype.constructor=p,p);function m(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}var d=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var e,t,r,a,l;if(!this.closed){this.closed=!0;var c=this._parentage;if(c)if(this._parentage=null,Array.isArray(c))try{for(var s=o(c),p=s.next();!p.done;p=s.next())p.value.remove(this)}catch(t){e={error:t}}finally{try{p&&!p.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}else c.remove(this);var m=this.initialTeardown;if(n(m))try{m()}catch(e){l=e instanceof f?e.errors:[e]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var y=o(d),v=y.next();!v.done;v=y.next()){var h=v.value;try{b(h)}catch(e){l=null!=l?l:[],e instanceof f?l=u(u([],i(l)),i(e.errors)):l.push(e)}}}catch(e){r={error:e}}finally{try{v&&!v.done&&(a=y.return)&&a.call(y)}finally{if(r)throw r.error}}}if(l)throw new f(l)}},e.prototype.add=function(t){var r;if(t&&t!==this)if(this.closed)b(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(r=this._finalizers)&&void 0!==r?r:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&m(t,e)},e.prototype.remove=function(t){var r=this._finalizers;r&&m(r,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}();function b(e){n(e)?e():e.unsubscribe()}d.EMPTY;var y=null,v=null,h=!1,g=!1,O={setTimeout:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var a=O.delegate;return(null==a?void 0:a.setTimeout)?a.setTimeout.apply(a,u([e,t],i(r))):setTimeout.apply(void 0,u([e,t],i(r)))},clearTimeout:function(e){var t=O.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function P(){}var S=w("C",void 0,void 0);function w(e,t,r){return{kind:e,value:t,error:r}}var j=function(e){function t(t){var r,a=e.call(this)||this;return a.isStopped=!1,t?(a.destination=t,((r=t)instanceof d||r&&"closed"in r&&n(r.remove)&&n(r.add)&&n(r.unsubscribe))&&t.add(a)):a.destination=x,a}return l(t,e),t.create=function(e,t,r){return new D(e,t,r)},t.prototype.next=function(e){this.isStopped?T(function(e){return w("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?T(w("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?T(S,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(d),E=Function.prototype.bind;function V(e,t){return E.call(e,t)}var C=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){F(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){F(e)}else F(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){F(e)}},e}(),D=function(e){function t(t,r,a){var l,o,i=e.call(this)||this;return n(t)||!t?l={next:null!=t?t:void 0,error:null!=r?r:void 0,complete:null!=a?a:void 0}:i&&g?((o=Object.create(t)).unsubscribe=function(){return i.unsubscribe()},l={next:t.next&&V(t.next,o),error:t.error&&V(t.error,o),complete:t.complete&&V(t.complete,o)}):l=t,i.destination=new C(l),i}return l(t,e),t}(j);function F(e){h||function(e){O.setTimeout((function(){if(!y)throw e;y(e)}))}(e)}function T(e,t){var r=v;r&&O.setTimeout((function(){return r(e,t)}))}var I,k,q,x={closed:!0,next:P,error:function(e){throw e},complete:P},A=function(e){function t(t,r,n,a,l,o){var i=e.call(this,t)||this;return i.onFinalize=l,i.shouldUnsubscribe=o,i._next=r?function(e){try{r(e)}catch(e){t.error(e)}}:e.prototype._next,i._error=a?function(e){try{a(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,i._complete=n?function(){try{n()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,i}return l(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(j);function $(e,t){return r=function(r,n){var a=0;r.subscribe(new A(n,(function(r){n.next(e.call(t,r,a++))}),void 0,void 0,void 0))},function(e){if(function(e){return n(null==e?void 0:e.lift)}(e))return e.lift((function(e){try{return r(e,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")};var r}function _(e,t,r,n,a,l,o){try{var i=e[l](o),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(n,a)}function L(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var l=e.apply(t,r);function o(e){_(l,n,a,o,i,"next",e)}function i(e){_(l,n,a,o,i,"throw",e)}o(void 0)}))}}class B{static fetchAllFlespiDevices(e){var n=this;return L((function*(){const a=(0,r.getBackendSrv)().fetch({url:e+n.routePath+"/gw/devices/all?fields=id%2Cname",method:"GET"});return(yield(0,t.lastValueFrom)(a)).data.result}))()}static fetchDeviceTelemetryParameters(e,n){var a=this;return L((function*(){const l=(0,r.getBackendSrv)().fetch({url:n+a.routePath+`/gw/devices/${e}/telemetry/all`,method:"GET"}),o=(yield(0,t.lastValueFrom)(l)).data.result[0].telemetry;if(null===o)return Promise.resolve([]);const i=[];for(const e in o)i.push(e);return i}))()}static fetchFlespiDevicesMessages(e,t,n,a,l,o,i){let c=`{"from":${a},"to":${l}`;return void 0!==o&&("average"===o||"minimum"===o||"maximum"===o)&&void 0!==i&&i>=10&&(c+=`,"generalize":${i},"method":"${o}"`),c+=',"fields":"',c+=t.join(","),c+=',timestamp"}',(0,r.getBackendSrv)().fetch({url:n+this.routePath+`/gw/devices/${e}/messages?data=${c}`,method:"GET"})}static fetchFlespiDevicesLogs(e,t,n,a,l){let o=`{"from":${a},"to":${l}`;return o+=',"fields":"',o+=t.join(","),o+=',timestamp"}',(0,r.getBackendSrv)().fetch({url:n+this.routePath+`/gw/devices/${e}/logs?data=${o}`,method:"GET"})}static fetchAllFlespiSubaccounts(e){var n=this;return L((function*(){const a=(0,r.getBackendSrv)().fetch({url:e+n.routePath+"/platform/subaccounts/all?fields=id%2Cname",method:"GET"});return(yield(0,t.lastValueFrom)(a)).data.result}))()}static fetchFlespiAccount(e){var n=this;return L((function*(){const a=(0,r.getBackendSrv)().fetch({url:e+n.routePath+"/platform/customer?fields=id%2Cname",method:"GET"});return(yield(0,t.lastValueFrom)(a)).data.result}))()}static fetchFlespiStatisticsParametersForAccount(e,n){var a=this;return L((function*(){const l=(0,r.getBackendSrv)().fetch({url:n+a.routePath+"/platform/customer/statistics?data=%7B%22reverse%22%3Atrue%2C%22count%22%3A1%7D",method:"GET",headers:{"x-flespi-cid":e}}),o=(yield(0,t.lastValueFrom)(l)).data.result[0];if(null===o)return Promise.resolve([]);const i=[];for(const e in o)i.push(e);return i}))()}static fetchFlespiAccountsStatistics(e,t,n,a,l,o,i){let c=`{"from":${a},"to":${l}`;return void 0!==o&&("average"===o||"minimum"===o||"maximum"===o)&&void 0!==i&&i>=10&&(c+=`,"generalize":${i},"method":"${o}"`),c+=',"fields":"',c+=t.join(","),c+=',timestamp"}',(0,r.getBackendSrv)().fetch({url:n+this.routePath+`/platform/customer/statistics?data=${c}`,method:"GET",headers:{"x-flespi-cid":e}})}static fetchAllFlespiStreams(e){var n=this;return L((function*(){const a=(0,r.getBackendSrv)().fetch({url:e+n.routePath+"/gw/streams/all?fields=id%2Cname",method:"GET"});return(yield(0,t.lastValueFrom)(a)).data.result}))()}static fetchFlespiStreamsLogs(e,t,n,a,l){let o=`{"from":${a},"to":${l}`;return o+=',"fields":"',o+=t.join(","),o+=',timestamp"}',(0,r.getBackendSrv)().fetch({url:n+this.routePath+`/gw/streams/${e}/logs?data=${o}`,method:"GET"})}static fetchAllFlespiContainers(e){var n=this;return L((function*(){const a=(0,r.getBackendSrv)().fetch({url:e+n.routePath+"/storage/containers/all?fields=id%2Cname",method:"GET"});return(yield(0,t.lastValueFrom)(a)).data.result}))()}static fetchFlespiContainerParameters(e,n,a){var l=this;return L((function*(){const o=(0,r.getBackendSrv)().fetch({url:n+l.routePath+`/storage/containers/${e}/messages?data={"max_count":1,"reverse":true,"fields":"${a}"}`,method:"GET"}),i=(yield(0,t.lastValueFrom)(o)).data.result[0].params;if(null===i)return Promise.resolve([]);const c=[];return Object.keys(i).map((e=>{c.push(e)})),c}))()}static fetchFlespiContainersMessages(e,t,n,a,l,o,i){let c=`{"left_key":${a},"right_key":${l}`;return void 0!==o&&("average"===o||"minimum"===o||"maximum"===o)&&void 0!==i&&i>=10&&(c+=`,"generalize":${i},"method":"${o}"`),c+=',"fields":"',c+=t.join(","),c+=',timestamp"}',(0,r.getBackendSrv)().fetch({url:n+this.routePath+`/storage/containers/${e}/messages?data=${c}`,method:"GET"})}static fetchAllFlespiCalculators(e){var n=this;return L((function*(){const a=(0,r.getBackendSrv)().fetch({url:e+n.routePath+"/gw/calcs/all?fields=id%2Cname",method:"GET"});return(yield(0,t.lastValueFrom)(a)).data.result}))()}static fetchFlespiDevicesAssignedToCalculator(e,n){var a=this;return L((function*(){const l=(0,r.getBackendSrv)().fetch({url:n+a.routePath+`/gw/devices/calcs.id=${e}?fields=id%2Cname`,method:"GET"});return(yield(0,t.lastValueFrom)(l)).data.result}))()}static fetchFlespiIntervalParameters(e,n){var a=this;return L((function*(){const l=(0,r.getBackendSrv)().fetch({url:n+a.routePath+`/gw/calcs/${e}/devices/all/intervals/last`,method:"GET"}),o=(yield(0,t.lastValueFrom)(l)).data.result[0];if(null===o)return Promise.resolve([]);const i=[];return Object.keys(o).map((e=>{i.push(e)})),i}))()}static fetchFlespiIntervals(e,t,n,a,l,o){let i=`{"begin":${l},"end":${o}`;return i+=',"fields":"',i+=n.join(","),i+=',begin,end"}',(0,r.getBackendSrv)().fetch({url:a+this.routePath+`/gw/calcs/${e}/devices/${t}/intervals/all?data=${i}`,method:"GET"})}}q="/flespi",(k="routePath")in(I=B)?Object.defineProperty(I,k,{value:q,enumerable:!0,configurable:!0,writable:!0}):I[k]=q;const N=/^(devices\.\*)|^(devices\.(\d+)\.parameters\.\*)/,Q=/^(accounts\.\*)|(accounts\.([\d,]+)\.statistics\.\*)/,R=/^(containers\.\*)|(containers\.([\d,]+)\.parameters\.\*)/,M=/^(calculators\.\*)|(calculators\.([\d,]+)\.devices\.\*)|(calculators\.([\d,]+)\.devices\.([\d,]+).parameters\.\*)/,G="devices",z="statistics",K="logs",U="containers",W="intervals",J=[{label:"Devices",value:G},{label:"Statistics",value:z},{label:"Logs",value:K},{label:"Intervals",value:W},{label:"Containers",value:U}],Y="average",H=[{label:"none",value:"none"},{label:"average",value:Y},{label:"maximum",value:"maximum"},{label:"minimum",value:"minimum"}],X="device",Z="stream",ee=[{label:"Device",value:X},{label:"Stream",value:Z}],te=[{label:"recv",value:"recv"},{label:"send",value:"send"},{label:"msgs",value:"msgs"}],re=[{label:"accepted",value:"accepted"},{label:"ack_latency",value:"ack_latency"},{label:"read",value:"read"},{label:"rejected",value:"rejected"},{label:"skipped",value:"skipped"}];function ne(e){return void 0===e.queryType&&void 0!==e.entity&&(e.queryType=G,"number"==typeof e.entity?(e.useDeviceVariable=!1,e.devicesSelected=[{label:e.entityLabel,value:"number"==typeof e.entity?e.entity:parseInt(e.entity,10)}]):(e.useDeviceVariable=!0,e.deviceVariable=e.entity),void 0!==e.param&&(e.param.includes("$")?(e.useTelemParamVariable=!0,e.telemParamVariable=e.param):(e.useTelemParamVariable=!1,e.telemParamsSelected=[],e.telemParamsSelected.push(e.param))),e.generalizationFunction=void 0!==e.func?e.func:Y,delete e.param,delete e.func,delete e.entity,delete e.entityLabel,!0)}function ae(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function le(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},l=Object.keys(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}const oe=(e,t,n,a,l,o,i)=>{if(""===e)return void l("");const c=[];var s,u;(0,r.getTemplateSrv)().replace(e,void 0,void 0,c),c[0]&&!0===c[0].found?(a(e),l(""),o((s=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){ae(e,t,r[t])}))}return e}({},t),u=null!=(u={[n]:e})?u:{},Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(u)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(u)).forEach((function(e){Object.defineProperty(s,e,Object.getOwnPropertyDescriptor(u,e))})),s)),i()):l(`Invalid variable: no variable ${e} is defined for the dashboard`)},ie=(e,t)=>({text:`#${t} - ${""!==e?e.replace(/\./g,"_"):"<noname>"}`,value:t}),ce=(e,t)=>({label:`#${t} - ${""!==e?e.replace(/\./g,"_"):"<noname>"}`,value:t}),se=(e,t)=>e.map((e=>{var r;if(void 0===e.value)throw new Error("Wrong item value. Item ID is expected.");return void 0!==t&&(t[e.value.toString()]=e.label?e.label:""),null===(r=e.value)||void 0===r?void 0:r.toString()})),ue=(e,t,n)=>{const a=(0,r.getTemplateSrv)().replace(e,t,"csv").split(",");if(void 0!==n){const t=(0,r.getTemplateSrv)().getVariables().find((t=>`$${t.name}`===e));if(void 0!==t){const e=JSON.parse(JSON.stringify(t)).options;a.map((t=>{e.find((e=>{e.value.split(":")[0]===t&&(n[t.toString()]=e.text)}))}))}}return a},pe=(e,t,r)=>{const n=[],a={},l=[];let o=0;const i=e.data.result,c=i.length;if(0===c)return{data:[]};for(let e=0;e<c;e++){let t=i[e];void 0!==t.key&&void 0!==t.params&&(t=t.params);let{timestamp:r}=t,c=le(t,["timestamp"]);const s=r?1e3*r:1e3*t.key;n.push(s);for(let e=0;e<l.length;e++){const t=l[e];a[t].push(void 0!==c[t]?c[t]:null),delete c[t]}Object.keys(c).map((e=>{const t=c[e];a[e]=[];for(let t=0;t<o;t++)a[e].push(null);a[e].push(t),l.push(e)})),o++}return fe(n,a,t,r)},fe=(t,r,n,a)=>{const l=new e.MutableDataFrame({refId:n,fields:[{name:"Time",type:e.FieldType.time,values:t}]});return Object.keys(r).map((t=>{if(r[t].length>0){let n;switch(typeof r[t][0]){case"number":n=e.FieldType.number;break;case"string":n=e.FieldType.string;break;case"boolean":n=e.FieldType.boolean;break;default:n=e.FieldType.other}l.addField({name:t,type:n,values:r[t],labels:void 0!==a?{item:`[${a}]`}:void 0})}})),{data:[l]}};function me(e,t,r,n,a,l,o){try{var i=e[l](o),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(n,a)}function de(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var l=e.apply(t,r);function o(e){me(l,n,a,o,i,"next",e)}function i(e){me(l,n,a,o,i,"throw",e)}o(void 0)}))}}const be={queryType:G,useDeviceVariable:!1,devicesSelected:[],deviceVariable:"",useTelemParamVariable:!1,telemParamsSelected:[],telemParamVariable:"",useAccountVariable:!1,accountsSelected:[],accountVariable:"",useStatParamVariable:!1,statParamsSelected:[],statParamVariable:"",generalizationFunction:"average",logsSourceType:X,useLogsSourceVariable:!1,logsSourcesSelected:[],logsSourceVariable:"",useLogsParamVariable:!1,logsParamsSelected:[],logsParamVariable:"",useContainerVariable:!1,containersSelected:[],containerVariable:"",useContParamVariable:!1,contParamsSelected:[],contParamVariable:"",useCalculatorVariable:!1,calculatorsSelected:[],calculatorVariable:"",useCalcDeviceVariable:!1,calcDevicesSelected:[],calcDeviceVariable:"",useIntParamVariable:!1,intParamsSelected:[],intParamVariable:""};class ye extends e.DataSourceApi{metricFindQuery(e,t){var n=this;return de((function*(){if("streams.*"===e.trim())return(yield B.fetchAllFlespiStreams(n.url)).map((e=>ie(e.name,e.id)));const a=(0,r.getTemplateSrv)().replace(e.trim(),t.scopedVars,"csv");let l=a.match(N);if(null!==l){if("devices.*"===l[0])return(yield B.fetchAllFlespiDevices(n.url)).map((e=>ie(e.name,e.id)));{const e=l[3];return(yield B.fetchDeviceTelemetryParameters(e,n.url)).map((e=>({text:e})))}}if(l=a.match(Q),null!==l){if("accounts.*"===l[0]){const e=yield Promise.all([B.fetchFlespiAccount(n.url),B.fetchAllFlespiSubaccounts(n.url)]);return(yield Promise.all(e)).flat().map((e=>ie(e.name,e.id)))}{const e=l[3];return(yield B.fetchFlespiStatisticsParametersForAccount(e,n.url)).map((e=>({text:e})))}}if(l=a.match(R),null!==l){if("containers.*"===l[0])return(yield B.fetchAllFlespiContainers(n.url)).map((e=>ie(e.name,e.id)));{const e=parseInt(l[3],10);return(yield B.fetchFlespiContainerParameters(e,n.url,"")).map((e=>({text:e})))}}if(l=a.match(M),null!=l){if("calculators.*"===l[0])return(yield B.fetchAllFlespiCalculators(n.url)).map((e=>ie(e.name,e.id)));if(l[0].endsWith(".devices.*")){const e=parseInt(l[3],10);return(yield B.fetchFlespiDevicesAssignedToCalculator(e,n.url)).map((e=>ie(e.name,e.id)))}{const e=l[5];return(yield B.fetchFlespiIntervalParameters(e,n.url)).map((e=>({text:e})))}}return Promise.resolve([])}))()}testDatasource(){var e=this;return de((function*(){const t=yield B.fetchAllFlespiDevices(e.url),r=yield B.fetchFlespiAccount(e.url),n=yield B.fetchAllFlespiSubaccounts(e.url),a=yield B.fetchAllFlespiStreams(e.url);return{status:"success",message:`Success! The configured token has access to ${t.length} flespi devices, ${a.length} streams, account ID ${r[0].id} and ${n.length} subaccounts.`}}))()}query(e){const n=e.targets.map((n=>{console.log(JSON.stringify(n)),ne(n);const{range:a}=e,l=Math.floor(a.from.valueOf()/1e3),o=Math.ceil(a.to.valueOf()/1e3),i=n.generalizationFunction;let c;if(void 0!==i&&("average"===i||"minimum"===i||"maximum"===i)){const t=e.scopedVars.__interval_ms?e.scopedVars.__interval_ms.value/1e3:0,r=e.maxDataPoints?e.maxDataPoints:0;(t>60||0!==t&&r>0&&(o-l)/t>r)&&(c=Math.floor((o-l)/r))}switch(n.queryType){case G:let a,s,u={};if(a=!0===n.useDeviceVariable?ue(n.deviceVariable,e.scopedVars,u):se(n.devicesSelected,u),s=!0===n.useTelemParamVariable?(0,r.getTemplateSrv)().replace(n.telemParamVariable,e.scopedVars,"csv").split(","):n.telemParamsSelected,0===a.length||0===s.length)return new t.Observable;console.log("query::devices::"+a+"::parameters::"+s+"::");const p=a.map((t=>B.fetchFlespiDevicesMessages(t,s,this.url,l,o,i,c).pipe($((r=>pe(r,n.refId+":"+t,a.length>1||e.targets.length>1?u[t.toString()]:void 0))))));return(0,t.merge)(...p);case z:let f,m,d={};if(f=!0===n.useAccountVariable?ue(n.accountVariable,e.scopedVars,d):se(n.accountsSelected,d),m=!0===n.useStatParamVariable?(0,r.getTemplateSrv)().replace(n.statParamVariable,e.scopedVars,"csv").split(","):n.statParamsSelected,0===f.length||0===m.length)return new t.Observable;if(console.log("query::statistics::accounts::"+f+"::parameters::"+m+"::"),Array.isArray(f)&&0===f.length||Array.isArray(m)&&0===m.length)return new t.Observable;const b=f.map((t=>B.fetchFlespiAccountsStatistics(t,m,this.url,l,o,i,c).pipe($((r=>pe(r,n.refId+":"+t,f.length>1||e.targets.length>1?d[t.toString()]:void 0))))));return(0,t.merge)(...b);case K:let y;switch(y=!0===n.useLogsParamVariable?(0,r.getTemplateSrv)().replace(n.logsParamVariable,e.scopedVars,"csv").split(","):n.logsParamsSelected,n.logsSourceType){case X:let r,a={};if(r=!0===n.useLogsSourceVariable?ue(n.logsSourceVariable,e.scopedVars,a):se(n.logsSourcesSelected,a),0===r.length||0===y.length)return new t.Observable;console.log("query::logs::devices::"+r+"::parameters::"+y+"::");const i=r.map((t=>B.fetchFlespiDevicesLogs(t,y,this.url,l,o).pipe($((l=>pe(l,n.refId+":"+t,r.length>1||e.targets.length>1?a[t.toString()]:void 0))))));return(0,t.merge)(...i);case Z:let c,s={};if(c=!0===n.useLogsSourceVariable?ue(n.logsSourceVariable,e.scopedVars,s):se(n.logsSourcesSelected,s),0===c.length||0===y.length)return new t.Observable;console.log("query::logs::streams::"+c+"::parameters::"+y+"::");const u=c.map((t=>B.fetchFlespiStreamsLogs(t,y,this.url,l,o).pipe($((r=>pe(r,n.refId+":"+t,c.length>1||e.targets.length>1?s[t.toString()]:void 0))))));return(0,t.merge)(...u);default:return new t.Observable}case U:let v,h,g={};if(v=!0===n.useContainerVariable?ue(n.containerVariable,e.scopedVars,g):se(n.containersSelected,g),h=!0===n.useContParamVariable?(0,r.getTemplateSrv)().replace(n.contParamVariable,e.scopedVars,"csv").split(","):n.contParamsSelected,0===v.length||0===h.length)return new t.Observable;console.log("query::containers::"+v+"::parameters::"+h+"::");const O=v.map((t=>B.fetchFlespiContainersMessages(t,h,this.url,l,o,i,c).pipe($((r=>pe(r,n.refId+":"+t,v.length>1||e.targets.length>1?g[t.toString()]:void 0))))));return(0,t.merge)(...O);case W:let P,S,w,j={},E={};if(P=!0===n.useCalculatorVariable?ue(n.calculatorVariable,e.scopedVars,j):se(n.calculatorsSelected,j),S=!0===n.useCalcDeviceVariable?ue(n.calcDeviceVariable,e.scopedVars,E):se(n.calcDevicesSelected,E),w=!0===n.useIntParamVariable?(0,r.getTemplateSrv)().replace(n.intParamVariable,e.scopedVars,"csv").split(","):n.intParamsSelected,0===P.length||0===S.length||0===w.length)return new t.Observable;console.log("query::intervals::calculators::"+P+"::calcdevices::"+S+"::params::"+w);const V=P.map((e=>{const r=S.map((t=>B.fetchFlespiIntervals(e,t,w,this.url,l,o).pipe($((r=>((e,t,r,n)=>{const a=e.data.result;if(0===a.length)return{data:[]};const l=[],o={},i=a.length;for(let e=0;e<i;e++){let r=a[e];l.push(1e3*r.begin),l.push(1e3*r.end);for(const e of t)if(void 0!==r[e]){void 0===o[e]&&(o[e]=[]);const t=o[e];t.push(r[e]),t.push(null)}}return fe(l,o,r,void 0)})(r,w,n.refId+":"+e+":"+t))))));return(0,t.merge)(...r)}));return(0,t.merge)(...V);default:return new t.Observable}}));return(0,t.merge)(...n)}constructor(e){super(e),function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(this,"url",void 0),this.url=e.url?e.url:""}}var ve=c(650),he=c.n(ve),ge=c(388);function Oe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Pe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Oe(e,t,r[t])}))}return e}function Se(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function we(e,t,r,n,a,l,o){try{var i=e[l](o),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(n,a)}function je(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ee(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){je(e,t,r[t])}))}return e}function Ve(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function Ce(e){const{onChange:t,onRunQuery:r,datasource:n,query:a}=e,[l,o]=(0,ve.useState)([]),[i,c]=(0,ve.useState)(a.useDeviceVariable),[s,u]=(0,ve.useState)(a.deviceVariable),[p,f]=(0,ve.useState)(a.devicesSelected),[m,d]=(0,ve.useState)("");return(0,ve.useEffect)((()=>{const e=(t=function*(){const e=(yield B.fetchAllFlespiDevices(n.url)).map((e=>ce(e.name,e.id)));o(e)},r=function(){var e=this,r=arguments;return new Promise((function(n,a){var l=t.apply(e,r);function o(e){we(l,n,a,o,i,"next",e)}function i(e){we(l,n,a,o,i,"throw",e)}o(void 0)}))},function(){return r.apply(this,arguments)});var t,r;e().catch(console.error)}),[n,a]),a.queryType!==G?he().createElement("div",null):he().createElement("div",{className:"gf-form"},he().createElement(ge.InlineLabel,{width:16,tooltip:"Choose devices for query"},"Devices"),he().createElement(ge.InlineField,{label:"Use dashboard variable"},he().createElement("div",{className:"gf-form-switch"},he().createElement(ge.Switch,{value:!!i,onChange:()=>{c(!i),t(Ve(Ee({},a),{useDeviceVariable:!a.useDeviceVariable}))}}))),i?he().createElement(ge.InlineField,{invalid:!!m,error:m},he().createElement(ge.Input,{name:"device",value:s,onChange:e=>{u(e.target.value)},onKeyDown:e=>{"Enter"===e.key&&oe(e.target.value,a,"deviceVariable",u,d,t,r)},onBlur:e=>{oe(e.target.value,a,"deviceVariable",u,d,t,r)},required:!0,type:"text",width:40,placeholder:"$device"})):he().createElement(ge.InlineField,null,he().createElement(ge.MultiSelect,{value:p,options:l,onChange:e=>{f(e),t(Ve(Ee({},a),{devicesSelected:e})),r()},width:40,placeholder:"Select device"})))}var De=c(980);function Fe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Te(e){const{onChange:t,query:r}=e,n=(0,De.defaults)(r,be),[a,l]=(0,ve.useState)(n.queryType);return he().createElement("div",{className:"gf-form"},he().createElement(ge.InlineField,{label:"Query Type",labelWidth:26},he().createElement(ge.RadioButtonGroup,{options:J,value:a,onChange:e=>{var n,a;l(e),t((n=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Fe(e,t,r[t])}))}return e}({},r),a=null!=(a={queryType:e})?a:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(a)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(a,e))})),n))}})))}function Ie(e,t,r,n,a,l,o){try{var i=e[l](o),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(n,a)}function ke(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){ke(e,t,r[t])}))}return e}function xe(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function Ae(e){const{onChange:t,onRunQuery:r,datasource:n,query:a}=e,[l,o]=(0,ve.useState)([]),[i,c]=(0,ve.useState)(a.useAccountVariable),[s,u]=(0,ve.useState)(a.accountVariable),[p,f]=(0,ve.useState)(a.accountsSelected),[m,d]=(0,ve.useState)("");return(0,ve.useEffect)((()=>{const e=(t=function*(){const e=yield Promise.all([B.fetchFlespiAccount(n.url),B.fetchAllFlespiSubaccounts(n.url)]),t=(yield Promise.all(e)).flat().map((e=>ce(e.name,e.id)));o(t)},r=function(){var e=this,r=arguments;return new Promise((function(n,a){var l=t.apply(e,r);function o(e){Ie(l,n,a,o,i,"next",e)}function i(e){Ie(l,n,a,o,i,"throw",e)}o(void 0)}))},function(){return r.apply(this,arguments)});var t,r;e().catch(console.error)}),[n,a]),a.queryType!==z?he().createElement("div",null):he().createElement("div",{className:"gf-form"},he().createElement(ge.InlineLabel,{width:16,tooltip:"Choose accounts for query"},"Accounts"),he().createElement(ge.InlineField,{label:"Use dashboard variable"},he().createElement("div",{className:"gf-form-switch"},he().createElement(ge.Switch,{value:!!i,onChange:()=>{c(!i),t(xe(qe({},a),{useAccountVariable:!a.useAccountVariable}))}}))),i?he().createElement(ge.InlineField,{invalid:!!m,error:m},he().createElement(ge.Input,{name:"account",value:s,onChange:e=>{u(e.target.value)},onKeyDown:e=>{"Enter"===e.key&&oe(e.target.value,a,"accountVariable",u,d,t,r)},onBlur:e=>{oe(e.target.value,a,"accountVariable",u,d,t,r)},required:!0,type:"text",width:40,placeholder:"$account"})):he().createElement(ge.InlineField,null,he().createElement(ge.MultiSelect,{value:p,options:l,onChange:e=>{f(e),t(xe(qe({},a),{accountsSelected:e})),r()},width:40,placeholder:"Select subaccount"})))}function $e(e,t,r,n,a,l,o){try{var i=e[l](o),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(n,a)}function _e(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Le(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_e(e,t,r[t])}))}return e}function Be(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function Ne(e){const{onChange:t,onRunQuery:r,datasource:n}=e,a=(0,De.defaults)(e.query,be),[l,o]=(0,ve.useState)(a.useTelemParamVariable),[i,c]=(0,ve.useState)(a.telemParamVariable),[s,u]=(0,ve.useState)((()=>a.telemParamsSelected?a.telemParamsSelected.map((e=>({label:e,value:e}))):[])),[p,f]=(0,ve.useState)(""),m=!0===a.useDeviceVariable?ue(a.deviceVariable,{}):se(a.devicesSelected),d=m.join(),b=(y=function*(e){if(""===d)return Promise.resolve([]);const t=yield Promise.all(m.map((t=>B.fetchDeviceTelemetryParameters(t,n.url).then((t=>t.filter((t=>t.toLowerCase().includes(e)))))))),r=(yield Promise.all(t)).flat(),a=new Set(r);return Array.from(a.values()).sort().map((e=>({value:e,label:e})))},v=function(){var e=this,t=arguments;return new Promise((function(r,n){var a=y.apply(e,t);function l(e){$e(a,r,n,l,o,"next",e)}function o(e){$e(a,r,n,l,o,"throw",e)}l(void 0)}))},function(e){return v.apply(this,arguments)});var y,v;return a.queryType!==G?he().createElement("div",null):he().createElement("div",{className:"gf-form"},he().createElement(ge.InlineLabel,{width:16,tooltip:"Choose telemetry parameters for query"},"Parameters"),he().createElement(ge.InlineField,{label:"Use dashboard variable"},he().createElement("div",{className:"gf-form-switch"},he().createElement(ge.Switch,{value:!!l,onChange:()=>{o(!l),t(Be(Le({},a),{useTelemParamVariable:!a.useTelemParamVariable}))}}))),l?he().createElement(ge.InlineField,{invalid:!!p,error:p},he().createElement(ge.Input,{name:"parameter",value:i,onChange:e=>{c(e.target.value),t(Be(Le({},a),{telemParamVariable:e.target.value}))},onKeyDown:e=>{"Enter"===e.key&&(r(),oe(e.target.value,a,"telemParamVariable",c,f,t,r))},onBlur:e=>{oe(e.target.value,a,"telemParamVariable",c,f,t,r)},required:!0,type:"text",width:40,placeholder:"$parameter"})):he().createElement(ge.InlineField,{labelWidth:16},he().createElement(ge.AsyncMultiSelect,{key:d,value:s,loadOptions:b,defaultOptions:!0,cacheOptions:!0,onChange:e=>{u(e),t(Be(Le({},a),{telemParamsSelected:e.map((e=>e.value))})),r()},width:40,noOptionsMessage:`Telemetry not found for devices' IDs: ${d}`,allowCustomValue:!0})))}function Qe(e,t,r,n,a,l,o){try{var i=e[l](o),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(n,a)}function Re(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Me(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Re(e,t,r[t])}))}return e}function Ge(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function ze(e){const{onChange:t,onRunQuery:r,datasource:n}=e,a=(0,De.defaults)(e.query,be),[l,o]=(0,ve.useState)(a.useStatParamVariable),[i,c]=(0,ve.useState)(a.statParamVariable),[s,u]=(0,ve.useState)((()=>a.statParamsSelected?a.statParamsSelected.map((e=>({label:e,value:e}))):[])),[p,f]=(0,ve.useState)(""),m=!0===a.useAccountVariable?ue(a.accountVariable,{}):se(a.accountsSelected),d=m.join(),b=(y=function*(e){if(""===d)return Promise.resolve([]);const t=yield Promise.all(m.map((t=>B.fetchFlespiStatisticsParametersForAccount(t,n.url).then((t=>t.filter((t=>t.toLowerCase().includes(e)))))))),r=(yield Promise.all(t)).flat(),a=new Set(r);return Array.from(a.values()).sort().map((e=>({value:e,label:e})))},v=function(){var e=this,t=arguments;return new Promise((function(r,n){var a=y.apply(e,t);function l(e){Qe(a,r,n,l,o,"next",e)}function o(e){Qe(a,r,n,l,o,"throw",e)}l(void 0)}))},function(e){return v.apply(this,arguments)});var y,v;return a.queryType!==z?he().createElement("div",null):he().createElement("div",{className:"gf-form"},he().createElement(ge.InlineLabel,{width:16,tooltip:"Choose statistics parameters for query"},"Parameters"),he().createElement(ge.InlineField,{label:"Use dashboard variable"},he().createElement("div",{className:"gf-form-switch"},he().createElement(ge.Switch,{value:!!l,onChange:()=>{o(!l),t(Ge(Me({},a),{useStatParamVariable:!a.useStatParamVariable}))}}))),l?he().createElement(ge.InlineField,{invalid:!!p,error:p},he().createElement(ge.Input,{name:"parameter",value:i,onChange:e=>{c(e.target.value),t(Ge(Me({},a),{statParamVariable:e.target.value}))},onKeyDown:e=>{"Enter"===e.key&&(r(),oe(e.target.value,a,"statParamVariable",c,f,t,r))},onBlur:e=>{oe(e.target.value,a,"statParamVariable",c,f,t,r)},required:!0,type:"text",width:40,placeholder:"$parameter"})):he().createElement(ge.InlineField,{labelWidth:16},he().createElement(ge.AsyncMultiSelect,{key:d,value:s,loadOptions:b,defaultOptions:!0,cacheOptions:!0,onChange:e=>{u(e),t(Ge(Me({},a),{statParamsSelected:e.map((e=>e.value))})),r()},width:40,noOptionsMessage:`Satistics not found for accounts' IDs: ${d}`,allowCustomValue:!0})))}function Ke(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ue(e){const{onChange:t,onRunQuery:r}=e,n=(0,De.defaults)(e.query,be),[a,l]=(0,ve.useState)({label:n.generalizationFunction,value:n.generalizationFunction});return n.queryType!==G&&n.queryType!==z&&n.queryType!==U?he().createElement("div",null):he().createElement("div",{className:"gf-form"},he().createElement(ge.InlineField,{label:"Generalization Function",labelWidth:26},he().createElement(ge.Select,{value:a,options:H,onChange:e=>{var a,o;l(e),t((a=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Ke(e,t,r[t])}))}return e}({},n),o=null!=(o={generalizationFunction:e.value})?o:{},Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(o)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(o)).forEach((function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(o,e))})),a)),r()}})))}function We(e,t,r,n,a,l,o){try{var i=e[l](o),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(n,a)}function Je(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ye(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Je(e,t,r[t])}))}return e}function He(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function Xe(e){const{onChange:t,onRunQuery:r,datasource:n,query:a}=e,[l,o]=(0,ve.useState)([]),[i,c]=(0,ve.useState)(a.useLogsSourceVariable),[s,u]=(0,ve.useState)(a.logsSourceVariable),[p,f]=(0,ve.useState)(a.logsSourcesSelected),[m,d]=(0,ve.useState)("");if((0,ve.useEffect)((()=>{const e=(t=function*(){let e;e=a.logsSourceType===X?(yield B.fetchAllFlespiDevices(n.url)).map((e=>ce(e.name,e.id))):(yield B.fetchAllFlespiStreams(n.url)).map((e=>ce(e.name,e.id))),o(e)},r=function(){var e=this,r=arguments;return new Promise((function(n,a){var l=t.apply(e,r);function o(e){We(l,n,a,o,i,"next",e)}function i(e){We(l,n,a,o,i,"throw",e)}o(void 0)}))},function(){return r.apply(this,arguments)});var t,r;e().catch(console.error)}),[n,a]),a.queryType!==K)return he().createElement("div",null);let b,y,v,h;switch(a.logsSourceType){case X:y="Devices",b="Choose devices for query",v="Select device",h="$device";break;case Z:y="Streams",b="Choose streams for query",v="Select stream",h="$stream"}return he().createElement("div",{className:"gf-form"},he().createElement(ge.InlineLabel,{width:16,tooltip:b},y),he().createElement(ge.InlineField,{label:"Use dashboard variable"},he().createElement("div",{className:"gf-form-switch"},he().createElement(ge.Switch,{value:!!i,onChange:()=>{c(!i),t(He(Ye({},a),{useLogsSourceVariable:!a.useLogsSourceVariable}))}}))),i?he().createElement(ge.InlineField,{invalid:!!m,error:m},he().createElement(ge.Input,{name:"logsSource",value:s,onChange:e=>{u(e.target.value)},onKeyDown:e=>{"Enter"===e.key&&oe(e.target.value,a,"logsSourceVariable",u,d,t,r)},onBlur:e=>{oe(e.target.value,a,"logsSourceVariable",u,d,t,r)},required:!0,type:"text",width:40,placeholder:h})):he().createElement(ge.InlineField,null,he().createElement(ge.MultiSelect,{value:p,options:l,onChange:e=>{f(e),t(He(Ye({},a),{logsSourcesSelected:e})),r()},width:40,placeholder:v})))}function Ze(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function et(e){const{onChange:t,query:r}=e,n=(0,De.defaults)(r,be),[a,l]=(0,ve.useState)(n.logsSourceType);return r.queryType!==K?he().createElement("div",null):he().createElement("div",{className:"gf-form"},he().createElement(ge.InlineField,{label:"Logs Source",labelWidth:26},he().createElement(ge.RadioButtonGroup,{options:ee,value:a,onChange:e=>{var n,a;l(e),t((n=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Ze(e,t,r[t])}))}return e}({},r),a=null!=(a={logsSourceType:e})?a:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(a)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(a,e))})),n))}})))}function tt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){tt(e,t,r[t])}))}return e}function nt(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function at(e){const{onChange:t,onRunQuery:r}=e,n=(0,De.defaults)(e.query,be),[a,l]=(0,ve.useState)(n.useLogsParamVariable),[o,i]=(0,ve.useState)(n.logsParamVariable),[c,s]=(0,ve.useState)((()=>n.logsParamsSelected?n.logsParamsSelected.map((e=>({label:e,value:e}))):[])),[u,p]=(0,ve.useState)("");if(n.queryType!==K)return he().createElement("div",null);let f;switch(n.logsSourceType){case X:f=te;break;case Z:f=re}return he().createElement("div",{className:"gf-form"},he().createElement(ge.InlineLabel,{width:16,tooltip:"Choose logs parameters for query"},"Parameters"),he().createElement(ge.InlineField,{label:"Use dashboard variable"},he().createElement("div",{className:"gf-form-switch"},he().createElement(ge.Switch,{value:!!a,onChange:()=>{l(!a),t(nt(rt({},n),{useLogsParamVariable:!n.useLogsParamVariable}))}}))),a?he().createElement(ge.InlineField,{invalid:!!u,error:u},he().createElement(ge.Input,{name:"parameter",value:o,onChange:e=>{i(e.target.value),t(nt(rt({},n),{logsParamVariable:e.target.value}))},onKeyDown:e=>{"Enter"===e.key&&(r(),oe(e.target.value,n,"logsParamVariable",i,p,t,r))},onBlur:e=>{oe(e.target.value,n,"logsParamVariable",i,p,t,r)},required:!0,type:"text",width:40,placeholder:"$parameter"})):he().createElement(ge.InlineField,{labelWidth:16},he().createElement(ge.MultiSelect,{value:c,options:f,onChange:e=>{s(e),t(nt(rt({},n),{logsParamsSelected:e.map((e=>e.value))})),r()},width:40,allowCustomValue:!0})))}function lt(e,t,r,n,a,l,o){try{var i=e[l](o),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(n,a)}function ot(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function it(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){ot(e,t,r[t])}))}return e}function ct(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function st(e){const{onChange:t,onRunQuery:r,datasource:n,query:a}=e,[l,o]=(0,ve.useState)([]),[i,c]=(0,ve.useState)(a.useContainerVariable),[s,u]=(0,ve.useState)(a.containerVariable),[p,f]=(0,ve.useState)(a.containersSelected),[m,d]=(0,ve.useState)("");return(0,ve.useEffect)((()=>{const e=(t=function*(){const e=(yield B.fetchAllFlespiContainers(n.url)).map((e=>ce(e.name,e.id)));o(e)},r=function(){var e=this,r=arguments;return new Promise((function(n,a){var l=t.apply(e,r);function o(e){lt(l,n,a,o,i,"next",e)}function i(e){lt(l,n,a,o,i,"throw",e)}o(void 0)}))},function(){return r.apply(this,arguments)});var t,r;e().catch(console.error)}),[n,a]),a.queryType!==U?he().createElement("div",null):he().createElement("div",{className:"gf-form"},he().createElement(ge.InlineLabel,{width:16,tooltip:"Choose containers for query"},"Containers"),he().createElement(ge.InlineField,{label:"Use dashboard variable"},he().createElement("div",{className:"gf-form-switch"},he().createElement(ge.Switch,{value:!!i,onChange:()=>{c(!i),t(ct(it({},a),{useContainerVariable:!a.useContainerVariable}))}}))),i?he().createElement(ge.InlineField,{invalid:!!m,error:m},he().createElement(ge.Input,{name:"container",value:s,onChange:e=>{u(e.target.value)},onKeyDown:e=>{"Enter"===e.key&&oe(e.target.value,a,"containerVariable",u,d,t,r)},onBlur:e=>{oe(e.target.value,a,"containerVariable",u,d,t,r)},required:!0,type:"text",width:40,placeholder:"$container"})):he().createElement(ge.InlineField,null,he().createElement(ge.MultiSelect,{value:p,options:l,onChange:e=>{f(e),t(ct(it({},a),{containersSelected:e})),r()},width:40,placeholder:"Select container"})))}function ut(e,t,r,n,a,l,o){try{var i=e[l](o),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(n,a)}function pt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ft(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){pt(e,t,r[t])}))}return e}function mt(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function dt(e){const{onChange:t,onRunQuery:r,datasource:n}=e,a=(0,De.defaults)(e.query,be),[l,o]=(0,ve.useState)(a.useContParamVariable),[i,c]=(0,ve.useState)(a.contParamVariable),[s,u]=(0,ve.useState)((()=>a.contParamsSelected?a.contParamsSelected.map((e=>({label:e,value:e}))):[])),[p,f]=(0,ve.useState)(""),m=a.containersSelected,d=m.map((e=>e.value)).join(),b=(y=function*(e){if(""===m.toString())return Promise.resolve([]);const t=yield Promise.all(m.map((t=>B.fetchFlespiContainerParameters(t.value?t.value:0,n.url,e).then((t=>t.filter((t=>t.toLowerCase().includes(e)))))))),r=(yield Promise.all(t)).flat(),a=new Set(r);return Array.from(a.values()).sort().map((e=>({value:e,label:e})))},v=function(){var e=this,t=arguments;return new Promise((function(r,n){var a=y.apply(e,t);function l(e){ut(a,r,n,l,o,"next",e)}function o(e){ut(a,r,n,l,o,"throw",e)}l(void 0)}))},function(e){return v.apply(this,arguments)});var y,v;return a.queryType!==U?he().createElement("div",null):he().createElement("div",{className:"gf-form"},he().createElement(ge.InlineLabel,{width:16,tooltip:"Choose container parameters for query"},"Parameters"),he().createElement(ge.InlineField,{label:"Use dashboard variable"},he().createElement("div",{className:"gf-form-switch"},he().createElement(ge.Switch,{value:!!l,onChange:()=>{o(!l),t(mt(ft({},a),{useContParamVariable:!a.useContParamVariable}))}}))),l?he().createElement(ge.InlineField,{invalid:!!p,error:p},he().createElement(ge.Input,{name:"parameter",value:i,onChange:e=>{c(e.target.value),t(mt(ft({},a),{contParamVariable:e.target.value}))},onKeyDown:e=>{"Enter"===e.key&&(r(),oe(e.target.value,a,"contParamVariable",c,f,t,r))},onBlur:e=>{oe(e.target.value,a,"contParamVariable",c,f,t,r)},required:!0,type:"text",width:40,placeholder:"$parameter"})):he().createElement(ge.InlineField,{labelWidth:16},he().createElement(ge.AsyncMultiSelect,{key:d,value:s,loadOptions:b,defaultOptions:!0,cacheOptions:!0,onChange:e=>{u(e),t(mt(ft({},a),{contParamsSelected:e.map((e=>e.value))})),r()},width:40,noOptionsMessage:`Container parameters not found for containers' IDs: ${d}`,allowCustomValue:!0})))}function bt(e,t,r,n,a,l,o){try{var i=e[l](o),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(n,a)}function yt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){yt(e,t,r[t])}))}return e}function ht(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function gt(e){const{onChange:t,onRunQuery:r,datasource:n,query:a}=e,[l,o]=(0,ve.useState)(a.calculatorsSelected),[i,c]=(0,ve.useState)([]),[s,u]=(0,ve.useState)(a.useCalculatorVariable),[p,f]=(0,ve.useState)(a.calculatorVariable),[m,d]=(0,ve.useState)("");return(0,ve.useEffect)((()=>{const e=(t=function*(){const e=(yield B.fetchAllFlespiCalculators(n.url)).map((e=>ce(e.name,e.id)));c(e)},r=function(){var e=this,r=arguments;return new Promise((function(n,a){var l=t.apply(e,r);function o(e){bt(l,n,a,o,i,"next",e)}function i(e){bt(l,n,a,o,i,"throw",e)}o(void 0)}))},function(){return r.apply(this,arguments)});var t,r;e().catch(console.error)}),[n,a]),a.queryType!==W?he().createElement("div",null):he().createElement("div",{className:"gf-form"},he().createElement(ge.InlineLabel,{width:16,tooltip:"Choose calculator for query"},"Calculator"),he().createElement(ge.InlineField,{label:"Use dashboard variable"},he().createElement("div",{className:"gf-form-switch"},he().createElement(ge.Switch,{value:!!s,onChange:()=>{u(!s),t(ht(vt({},a),{useCalculatorVariable:!a.useCalculatorVariable}))}}))),s?he().createElement(ge.InlineField,{invalid:!!m,error:m},he().createElement(ge.Input,{name:"calculator",value:p,onChange:e=>{f(e.target.value)},onKeyDown:e=>{"Enter"===e.key&&oe(e.target.value,a,"calculatorVariable",f,d,t,r)},onBlur:e=>{oe(e.target.value,a,"calculatorVariable",f,d,t,r)},required:!0,type:"text",width:40,placeholder:"$calculator"})):he().createElement(ge.InlineField,null,he().createElement(ge.MultiSelect,{placeholder:"Select calculator",value:l,options:i,width:40,onChange:e=>{o(e),t(ht(vt({},a),{calculatorsSelected:e})),r()}})))}function Ot(e,t,r,n,a,l,o){try{var i=e[l](o),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(n,a)}function Pt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function St(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Pt(e,t,r[t])}))}return e}function wt(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function jt(e){const{onChange:t,onRunQuery:r,datasource:n,query:a}=e,[l,o]=(0,ve.useState)(a.calcDevicesSelected),[i,c]=(0,ve.useState)(a.useCalcDeviceVariable),[s,u]=(0,ve.useState)(a.calcDeviceVariable),[p,f]=(0,ve.useState)(""),m=(!0===a.useCalculatorVariable?ue(a.calculatorVariable,{}):se(a.calculatorsSelected)).join(),d=(b=function*(e){if(""===m)return Promise.resolve([]);const t=(yield Promise.all(a.calculatorsSelected.map((t=>B.fetchFlespiDevicesAssignedToCalculator(t.value?t.value:0,n.url).then((t=>t.filter((t=>t.name.toLowerCase().includes(e))))))))).flat();return Array.from(new Set(t).values()).sort().map((e=>ce(e.name,e.id)))},y=function(){var e=this,t=arguments;return new Promise((function(r,n){var a=b.apply(e,t);function l(e){Ot(a,r,n,l,o,"next",e)}function o(e){Ot(a,r,n,l,o,"throw",e)}l(void 0)}))},function(e){return y.apply(this,arguments)});var b,y;return a.queryType!==W?he().createElement("div",null):he().createElement("div",{className:"gf-form"},he().createElement(ge.InlineLabel,{width:16,tooltip:"Choose calc's device for query"},"Device"),he().createElement(ge.InlineField,{label:"Use dashboard variable"},he().createElement("div",{className:"gf-form-switch"},he().createElement(ge.Switch,{value:!!i,onChange:()=>{c(!i),t(wt(St({},a),{useCalcDeviceVariable:!a.useCalcDeviceVariable}))}}))),i?he().createElement(ge.InlineField,{invalid:!!p,error:p},he().createElement(ge.Input,{name:"calcdevice",value:s,onChange:e=>{u(e.target.value)},onKeyDown:e=>{"Enter"===e.key&&oe(e.target.value,a,"calcDeviceVariable",u,f,t,r)},onBlur:e=>{oe(e.target.value,a,"calcDeviceVariable",u,f,t,r)},required:!0,type:"text",width:40,placeholder:"$calcdevice"})):he().createElement(ge.InlineField,null,he().createElement(ge.AsyncMultiSelect,{key:m,value:l,loadOptions:d,onChange:e=>{o(e),t(wt(St({},a),{calcDevicesSelected:e})),r()},defaultOptions:!0,cacheOptions:!0,width:40,placeholder:""})))}function Et(e,t,r,n,a,l,o){try{var i=e[l](o),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(n,a)}function Vt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ct(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Vt(e,t,r[t])}))}return e}function Dt(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function Ft(e){const{onChange:t,onRunQuery:r,datasource:n,query:a}=e,[l,o]=(0,ve.useState)(a.useIntParamVariable),[i,c]=(0,ve.useState)(a.intParamVariable),[s,u]=(0,ve.useState)((()=>a.intParamsSelected?a.intParamsSelected.map((e=>({label:e,value:e}))):[])),[p,f]=(0,ve.useState)(""),m=!0===a.useCalculatorVariable?ue(a.calculatorVariable,{}):se(a.calculatorsSelected),d=m.join(),b=(y=function*(e){if(""===d)return Promise.resolve([]);const t=(yield Promise.all(m.map((t=>B.fetchFlespiIntervalParameters(t,n.url).then((t=>t.filter((t=>t.toLowerCase().includes(e))))))))).flat();return Array.from(new Set(t).values()).sort().map((e=>({value:e,label:e})))},v=function(){var e=this,t=arguments;return new Promise((function(r,n){var a=y.apply(e,t);function l(e){Et(a,r,n,l,o,"next",e)}function o(e){Et(a,r,n,l,o,"throw",e)}l(void 0)}))},function(e){return v.apply(this,arguments)});var y,v;return a.queryType!==W?he().createElement("div",null):he().createElement("div",{className:"gf-form"},he().createElement(ge.InlineLabel,{width:16,tooltip:"Choose interval parameters for query"},"Parameters"),he().createElement(ge.InlineField,{label:"Use dashboard variable"},he().createElement("div",{className:"gf-form-switch"},he().createElement(ge.Switch,{value:!!l,onChange:()=>{o(!l),t(Dt(Ct({},a),{useIntParamVariable:!a.useIntParamVariable}))}}))),l?he().createElement(ge.InlineField,{invalid:!!p,error:p},he().createElement(ge.Input,{name:"parameter",value:i,onChange:e=>{c(e.target.value),t(Dt(Ct({},a),{intParamVariable:e.target.value}))},onKeyDown:e=>{"Enter"===e.key&&(r(),oe(e.target.value,a,"intParamVariable",c,f,t,r))},onBlur:e=>{oe(e.target.value,a,"intParamVariable",c,f,t,r)},required:!0,type:"text",width:40,placeholder:"$parameter"})):he().createElement(ge.InlineField,{labelWidth:16},he().createElement(ge.AsyncMultiSelect,{key:d,value:s,loadOptions:b,defaultOptions:!0,cacheOptions:!0,onChange:e=>{u(e),t(Dt(Ct({},a),{intParamsSelected:e.map((e=>e.value))})),r()},width:40,noOptionsMessage:`Intervals not found for calculators' IDs: ${d}`,allowCustomValue:!0,placeholder:""})))}const Tt=new e.DataSourcePlugin(ye).setConfigEditor((function(e){const{onOptionsChange:t,options:r}=e,{secureJsonFields:n}=r,a=r.secureJsonData||{};return he().createElement("div",{className:"gf-form-group"},he().createElement(ge.InlineField,{label:"Flespi Token",labelWidth:12},he().createElement(ge.SecretInput,{isConfigured:n&&n.apiKey,value:a.apiKey||"",placeholder:"paste your flespi token here",width:40,onReset:()=>{t(Se(Pe({},r),{secureJsonFields:Se(Pe({},r.secureJsonFields),{apiKey:!1}),secureJsonData:Se(Pe({},r.secureJsonData),{apiKey:""})}))},onChange:e=>{t(Se(Pe({},r),{secureJsonData:{apiKey:e.target.value}}))}})))})).setQueryEditor((function(e){const{onChange:t,onRunQuery:r,datasource:n,query:a}=e;return!0===ne(a)&&t(a),he().createElement(he().Fragment,null,he().createElement(Te,{datasource:n,query:a,onRunQuery:r,onChange:t}),he().createElement(Ce,{datasource:n,query:a,onRunQuery:r,onChange:t}),he().createElement(Ne,{datasource:n,query:a,onRunQuery:r,onChange:t}),he().createElement(Ae,{datasource:n,query:a,onRunQuery:r,onChange:t}),he().createElement(ze,{datasource:n,query:a,onRunQuery:r,onChange:t}),he().createElement(st,{datasource:n,query:a,onRunQuery:r,onChange:t}),he().createElement(dt,{datasource:n,query:a,onRunQuery:r,onChange:t}),he().createElement(Ue,{datasource:n,query:a,onRunQuery:r,onChange:t}),he().createElement(et,{datasource:n,query:a,onRunQuery:r,onChange:t}),he().createElement(Xe,{datasource:n,query:a,onRunQuery:r,onChange:t}),he().createElement(at,{datasource:n,query:a,onRunQuery:r,onChange:t}),he().createElement(gt,{datasource:n,query:a,onRunQuery:r,onChange:t}),he().createElement(jt,{datasource:n,query:a,onRunQuery:r,onChange:t}),he().createElement(Ft,{datasource:n,query:a,onRunQuery:r,onChange:t}))}))})(),s})()));
//# sourceMappingURL=module.js.map